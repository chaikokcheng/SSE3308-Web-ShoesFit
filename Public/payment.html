<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShoesFit Checkout</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans&display=swap"
        rel="stylesheet">


    <link rel="stylesheet" type="text/css" href="main.css">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">        
        <a class="navbar-brand" href="index.html">
            <img src="images/shoesfitlogo.jpg" alt="ShoesFit Logo" style="height: 50px; margin-right: 10px;">ShoesFit
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="cart.html" title="Cart">
                        <i class="fas fa-shopping-cart"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link"  title="User Profile" id="profile-icon">
                        <i class="fas fa-user"></i>
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h2>CHECKOUT</h2>
                <p>Please complete your checkout within <strong>20 minutes</strong>.</p>
            </div>
            <div class="timer">
                <div id="countdown"></div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <h3>CONTACT</h3>
                <div class="form-container">
                    <form method="post">
                        <div class="form-row">
                            <div class="form-group col-md-6 formTitle-styling" id="emailFormGroup">
                                <label for="contact">Email *</label>
                                <div class="input-group">
                                    <input type="contact" class="form-control" id="emailInput" required>
                                    <div class="icon-position">
                                        <i class="fas fa-times-circle text-danger" id="email-checkIcon"></i>
                                    </div>
                                </div>
                                <span class="text-danger" id="emailErrorMessage">
                                </span>
                            </div>
                        </div>
                    </form>
                </div>

                <hr class="margin">

                <h3>ADDRESS</h3>
                <form method="post" class="addressSection">
                    <div class="formTitle-styling">
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="firstName">First Name*</label>
                                <input type="text" class="form-control" id="firstName" required>
                                <span class="text-danger" id="firstNameErrorMessage"></span>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="lastName">Last Name*</label>
                                <input type="text" class="form-control" id="lastName" required>
                                <span class="text-danger" id="lastNameErrorMessage"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="streetAddress">Street Address*</label>
                            <input type="text" class="form-control" id="streetAddress" required>
                            <span class="text-danger" id="addressErrorMessage"></span>
                        </div>
                        <div class="form-group">
                            <label for="additionalInfo">Additional Info</label>
                            <textarea class="form-control" id="additionalInfo"></textarea>
                            <span class="formFooter-styling">Additional address information</span>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="city">City*</label>
                                <input type="text" class="form-control" id="city" required>
                                <span class="text-danger" id="cityErrorMessage"></span>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="state">State*</label>
                                <input type="text" class="form-control" id="state" required>
                                <span class="text-danger" id="stateErrorMessage"></span>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="postcode">Postcode*</label>
                                <input type="text" class="form-control" id="postcode" required>
                                <span class="formFooter-styling" id="PC-Footer"></span>
                                <span class="text-danger" id="postcodeErrorMessage"></span>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="phoneNumber">Phone Number*</label>
                                <input type="text" class="form-control" id="phoneNumber" required>
                                <span class="formFooter-styling" id="PhNum-Footer"></span>
                                <span class="text-danger" id="phoneNumberErrorMessage"></span>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-width" id="addressButton" disabled>NEXT</button>
                </form>

                <hr class="margin">

                <h3>SHIPPING METHODS</h3>
                <div class="shippingSection formTitle-styling">
                    <div class="form-group shipping-border ">
                        <label class="d-block">
                            <input type="radio" name="shipping" checked>
                            <img src="images/ninja_van.png" alt="Ninja Van" class="shippingImage-size "> &nbsp;
                            Ninja Van
                            <span class="float-right text-align">$10</span>
                        </label>
                    </div>
                    <br>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="t&c">
                        <label class="form-check-label" for="t&c">Yes, I accept the <a href="#">Terms &
                                Conditions</a>*</label>
                    </div>
                    <button type="button" class="btn btn-width" id="shippingButton" disabled>NEXT</button>
                </div>

                <hr class="margin">

                <h3>PAYMENT</h3>
                <div class="paymentSection">
                    <p class="safety-block">Payments are SSL encrypted so that your credit card and payment details stay
                        safe. &nbsp; <i class="fas fa-lock"></i>
                    </p>
                    <div class="form-group shipping-border">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="paymentMethod" id="creditCardRadio"
                                value="creditCard">
                            <label class="form-check-label paymentMethod-title" for="creditCardRadio">
                                Credit/Debit Card
                            </label>
                        </div>
                        <div class="form-group formTitle-styling pt-4" id="creditCardDetails">
                            <div class="form-group">
                                <label for="nameOnCard">Name on card</label>
                                <input class="form-control" id="nameOnCard" placeholder="Emily Fracnis">
                                <div class="text-danger" id="nameOnCardValidity"></div>
                            </div>
                            <div class="form-group">
                                <label for="cardNumber">Card number</label>
                                <input class="form-control" id="cardNumber" placeholder="1234 5678 9012 3456"
                                    maxlength="19" oninput="formatCardNumber(this)">
                                <div class="text-danger" id="cardNumberValidity"></div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="expiryDate">Expiry date</label>
                                        <input class="form-control" id="expiryDate" placeholder="MM/YY">
                                        <div class="text-danger" id="expiryDateValidity"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="cvc">CVC/CVV</label>
                                        <input class="form-control" id="cvc" placeholder="3 digits" maxlength="3">
                                        <div class="text-danger" id="cvcValidity"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group shipping-border">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="paymentMethod" id="onlineBankingRadio"
                                value="onlineBanking">
                            <label class="form-check-label paymentMethod-title" for="onlineBankingRadio">
                                Online Banking
                            </label>
                        </div>
                        <label class="d-block">
                            <select class="form-control" id="onlineBankingDetails">
                                <option hidden disabled selected style="display:none;">Select your bank</option>
                                <option value="am">Am Online</option>
                                <option value="cimb">CIMB Clicks</option>
                                <option value="pbe">Public Bank</option>
                            </select>
                        </label>
                    </div>
                    <button type="button" class="btn btn-width" id="paymentButton" data-bs-toggle="modal"
                        data-bs-target="#myModal" disabled>PLACE ORDER</button>
                </div>
            </div>

            <div class="col-md-1"></div>

            <div class="col-md-5">
                <h3>YOUR CART</h3>
                <section id="cartSection"></section>
                <br>
                <button type="btn" class="cart-btn" data-bs-toggle="modal" data-bs-target="codeModal">USE A PROMO
                    CODE</button>
                <br>
                <br>
                <hr>
                <div class="row">
                    <div class="col-6">
                        Cart Subtotal
                    </div>
                    <div class="col-6 text-right font-italic">
                        $ <span id="productAmount"></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        Shipping
                    </div>
                    <div class="col-6 text-right" id="shipping_charge">
                        <i>$ 10.00</i>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-6">
                        Order Amount
                    </div>
                    <div class="col-6 text-right font-weight-bold" style="font-size: 20px; margin-bottom: 20px;">
                        $ <span id="total-price"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="codeModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Enter Your Promo Code</h5>
                    <button type="button" class="btn-close" data-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form method="post">
                        <div class="form-group">
                            <label for="promoCode">Promo Code:</label>
                            <input type="text" class="form-control" id="promoCode" placeholder="Enter promo code">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary">Apply</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="alert alert-success"><strong>Order confirmed !</strong></h4>
                    <a href="index.html"><button type="button" class="btn-close"></button></a>
                </div>
                <div class="modal-body">
                    Your payment has been successfully completed.
                </div>
                <div class="modal-footer">
                    <a href="orderSummary.php"><button type="button" class="btn" id="summaryBtn">View Order
                            Summary</button></a>
                </div>
            </div>
        </div>
    </div>
    <div id="sidebar" class="sidebar">
        <a href="#" class="closebtn" id="closebtn"><span>CLOSE</span>&times;</a>
        <a href="profile.php" id="profile">Profile</a>
        <a href="orderHistory.php"id="orderHistory">Order History</a>
        <a href="login.php" id="logout"><span>LOGOUT</span></a>
    </div>

    <br><br>


    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cartSection = document.getElementById('cartSection');
            const productAmt = document.getElementById('productAmount');
            const totalPrice = document.getElementById('total-price');
            const shippingCharge = 10;
            let total = 0;

            const cart = localStorage.getItem('cart') ? JSON.parse(localStorage.getItem('cart')) : [];
            $('#total_items_count').text(cart.length);

            if (cart.length === 0) {
                cartSection.innerHTML = '<p>Your cart is empty.</p>';
            } else {
                fetch('products.json')
                    .then(response => response.json())
                    .then(data => {
                        const cartHTML = cart.map(cartItem => {
                            const product = data.products.find(p => p.id === cartItem.productId);
                            if (product) {
                                total += product.price * cartItem.quantity;
                                return `
                                <div class="order-border" data-id="${product.id}">
                    <img src="${product.img}" alt="${product.name}" class="shoeImage-size">
                    <div class="order-details">
                        <h6 style="font-size: 18px;">${product.name}</h6>
                        <p class="shoe-colour">${cartItem.color}</p>
                        <div class="cart-text">
                            <p>Price: $ ${product.price}</p>
                            <p>Qty: ${cartItem.quantity}</p>
                            <p>Size: ${cartItem.size}</p>
                        </div>
                    </div>
                </div>
                        `;
                            }
                            return '';
                        }).join('');

                        cartSection.innerHTML = cartHTML;
                        productAmt.innerText = total.toFixed(2);
                        totalPrice.innerText = (total + shippingCharge).toFixed(2);
                    });
            }

        });
        document.getElementById("profile-icon").onclick = function () {
        var sidebar = document.getElementById("sidebar");
        if (sidebar.style.width === "200px") {
            sidebar.style.width = "0";
        } else {
            sidebar.style.width = "200px";
        }
        }

        document.getElementById("closebtn").onclick = function () {
            document.getElementById("sidebar").style.width = "0";
        }
    </script>

</body>

</html>